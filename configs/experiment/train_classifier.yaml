# @package _global_

defaults:
  - override /datamodule: jetclass_stream.yaml
  - override /model: classifier.yaml
  - override /callbacks: finetune.yaml

# Faster warmup
model:
  scheduler:
    warmup_steps: 5000

# Dont train for too long
trainer:
  max_epochs: null
  max_steps: 100_000

# Key parameters for fine-tuning
n_jets: 1000_000

# Never finetune on the full dataset, always 1 file and n_jets
datamodule:
  train_set:
    n_jets: ${n_jets}
  val_set:
    n_jets: ${n_jets}
  test_set:
    n_files: 1 # No njets limit on test set

# Bookkeeping
project_name: jetssl_finetune_paper
network_name: classifier_${n_jets}
