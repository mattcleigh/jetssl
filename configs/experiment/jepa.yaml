# @package _global_
defaults:
  - override /datamodule: jetclass_masked
  - override /model: jepa

# Datamodule with two masking operations
datamodule:
  batch_size: 1000 # Can't fit 1k with joint embedder
  transforms:
    - _target_: src.datamodules.preprocessing.batch_masking
      _partial_: true
      fn:
        _target_: src.datamodules.masking.random_masking
        _partial_: true
        mask_fraction: 0.3
      key: null_mask
    - _target_: src.datamodules.preprocessing.batch_masking
      _partial_: true
      fn:
        _target_: src.datamodules.masking.random_masking
        _partial_: true
        mask_fraction: 0.3
      key: target_mask
    - _target_: src.datamodules.preprocessing.preprocess
      _partial_: true
      fn:
        _target_: joblib.load
        filename: ${paths.root_dir}/resources/cst_quant.joblib

trainer:
  max_steps: 1000_000
  val_check_interval: 50_000

# Model modifications
project_name: jetssl2
network_name: jepa
