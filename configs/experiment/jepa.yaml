# @package _global_
defaults:
  - override /datamodule: jetclass_masked
  - override /model: jepa

# Datamodule with two masking operations
datamodule:
  transforms:
    - _target_: src.datamodules.preprocessing.batch_masking
      _partial_: true
      fn:
        _target_: src.datamodules.masking.random_masking
        _partial_: true
        mask_fraction: 0.5
      key: null_mask
    - _target_: src.datamodules.preprocessing.batch_masking
      _partial_: true
      fn:
        _target_: src.datamodules.masking.random_masking
        _partial_: true
        mask_fraction: 0.5
      key: target_mask
    - _target_: src.datamodules.preprocessing.preprocess
      _partial_: true
      fn:
        _target_: joblib.load
        filename: ${paths.root_dir}/resources/preprocessor_all.joblib

trainer:
  max_epochs: 1000
  val_check_interval: 5000

# Model modifications
project_name: jetssl2
network_name: jepa
